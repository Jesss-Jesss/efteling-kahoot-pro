<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <title>Efteling Kahoot Pro - Dashboard</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>

<div id="dashboard">

    <h1>ðŸŽ¢ Efteling Kahoot Pro</h1>

    <!-- GAME CODE -->
    <div class="block">
        <h2>Game Code</h2>
        <p id="gameCode">EFTEL-123456</p>
    </div>

    <!-- SPELERS -->
    <div class="block">
        <h2>Spelers</h2>
        <ul id="playersList"></ul>
    </div>

    <!-- CONTROL -->
    <div class="block">
        <h2>Control</h2>
        <button onclick="resetGame()">Reset Game</button>
    </div>

</div>

<script>

// ðŸ”’ VASTE GAME ID (MOET GELIJK ZIJN AAN SERVER)
const MANUAL_GAME_ID = "EFTEL-123456";

// ðŸ“Œ QR CODE MAKEN
window.addEventListener("load", () => {

    const fullUrl = window.location.origin + "/player";

    document.getElementById("gameCode").innerText =
        "Game ID: " + MANUAL_GAME_ID;

    loadPlayers();

    // ðŸ”„ elke 2 seconden spelers vernieuwen
    setInterval(loadPlayers, 2000);
});


// ðŸ“Œ SPELERS LADEN
function loadPlayers() {

    fetch("/scores-full")
    .then(res => res.json())
    .then(data => {

        const list = document.getElementById("playersList");
        list.innerHTML = "";

        if (!data.players) return;

        data.players.forEach(player => {

            const li = document.createElement("li");
            li.innerText = player.name + " (" + player.character + ")";
            list.appendChild(li);

        });

    });
}


// ðŸ”„ GAME RESETTEN
function resetGame() {

    fetch("/reset-game", { method: "POST" })
    .then(() => {
        alert("Game gereset!");
        location.reload();
    });

}

</script>

</body>
</html>

